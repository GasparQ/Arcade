<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Arcade: Porting from FLAC 1.1.2 to 1.1.3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="spaceship.bmp"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arcade
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Tek2 project for Epitech. Made by Gaspar_q, Gouet_v and Veyrie_f</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Porting from FLAC 1.1.2 to 1.1.3<div class="ingroups"><a class="el" href="group__porting.html">Porting Guide for New Versions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This module describes porting from <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.2 to <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.3.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Porting from FLAC 1.1.2 to 1.1.3:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__porting__1__1__2__to__1__1__3.png" border="0" alt="" usemap="#group____porting____1____1____2____to____1____1____3"/>
<map name="group____porting____1____1____2____to____1____1____3" id="group____porting____1____1____2____to____1____1____3">
<area shape="rect" id="node2" href="group__porting.html" title="Porting Guide for New\l Versions" alt="" coords="6,5,157,46"/></map>
</td></tr></table></center>
</div>
<p>This module describes porting from <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.2 to <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.3. </p>
<p>The main change between the APIs in 1.1.2 and 1.1.3 is that they have been simplified. First, libOggFLAC has been merged into libFLAC and libOggFLAC++ has been merged into libFLAC++. Second, both the three decoding layers and three encoding layers have been merged into a single stream decoder and stream encoder. That is, the functionality of FLAC__SeekableStreamDecoder and FLAC__FileDecoder has been merged into <a class="el" href="struct_f_l_a_c_____stream_decoder.html">FLAC__StreamDecoder</a>, and FLAC__SeekableStreamEncoder and FLAC__FileEncoder into <a class="el" href="struct_f_l_a_c_____stream_encoder.html">FLAC__StreamEncoder</a>. Only the <a class="el" href="struct_f_l_a_c_____stream_decoder.html">FLAC__StreamDecoder</a> and <a class="el" href="struct_f_l_a_c_____stream_encoder.html">FLAC__StreamEncoder</a> remain. What this means is there is now a single API that can be used to encode or decode streams to/from native <a class="el" href="namespace_f_l_a_c.html">FLAC</a> or Ogg <a class="el" href="namespace_f_l_a_c.html">FLAC</a> and the single API can work on both seekable and non-seekable streams.</p>
<p>Instead of creating an encoder or decoder of a certain layer, now the client will always create a <a class="el" href="struct_f_l_a_c_____stream_encoder.html">FLAC__StreamEncoder</a> or <a class="el" href="struct_f_l_a_c_____stream_decoder.html">FLAC__StreamDecoder</a>. The old layers are now differentiated by the initialization function. For example, for the decoder, FLAC__stream_decoder_init() has been replaced by <a class="el" href="group__flac__stream__decoder.html#ga32c28a56a2bdfa2333edbd3d991894d7">FLAC__stream_decoder_init_stream()</a>. This init function takes callbacks for the I/O, and the seeking callbacks are optional. This allows the client to use the same object for seekable and non-seekable streams. For decoding a <a class="el" href="namespace_f_l_a_c.html">FLAC</a> file directly, the client can use <a class="el" href="group__flac__stream__decoder.html#ga1692108a97012d1c5f79baf7df012c33">FLAC__stream_decoder_init_file()</a> and pass just a filename and fewer callbacks; most of the other callbacks are supplied internally. For situations where fopen()ing by filename is not possible (e.g. Unicode filenames on Windows) the client can instead open the file itself and supply the FILE* to <a class="el" href="group__flac__stream__decoder.html#ga38f9eb46bf112af205f86b4cbac9980c">FLAC__stream_decoder_init_FILE()</a>. The init functions now returns a FLAC__StreamDecoderInitStatus instead of FLAC__StreamDecoderState. Since the callbacks and client data are now passed to the init function, the FLAC__stream_decoder_set_*_callback() functions and FLAC__stream_decoder_set_client_data() are no longer needed. The rest of the calls to the decoder are the same as before.</p>
<p>There are counterpart init functions for Ogg <a class="el" href="namespace_f_l_a_c.html">FLAC</a>, e.g. <a class="el" href="group__flac__stream__decoder.html#ga78bf285b54e5aaee73a214c108683a72">FLAC__stream_decoder_init_ogg_stream()</a>. All the rest of the calls and callbacks are the same as for native <a class="el" href="namespace_f_l_a_c.html">FLAC</a>.</p>
<p>As an example, in <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.2 a seekable stream decoder would have been set up like so:</p>
<div class="fragment"><div class="line">FLAC__SeekableStreamDecoder *decoder = FLAC__seekable_stream_decoder_new();</div>
<div class="line"><span class="keywordflow">if</span>(decoder == <a class="code" href="begin__code_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) do_something;</div>
<div class="line">FLAC__seekable_stream_decoder_set_md5_checking(decoder, <span class="keyword">true</span>);</div>
<div class="line">[... other settings ...]</div>
<div class="line">FLAC__seekable_stream_decoder_set_read_callback(decoder, my_read_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_seek_callback(decoder, my_seek_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_tell_callback(decoder, my_tell_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_length_callback(decoder, my_length_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_eof_callback(decoder, my_eof_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_write_callback(decoder, my_write_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_metadata_callback(decoder, my_metadata_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_error_callback(decoder, my_error_callback);</div>
<div class="line">FLAC__seekable_stream_decoder_set_client_data(decoder, my_client_data);</div>
<div class="line"><span class="keywordflow">if</span>(FLAC__seekable_stream_decoder_init(decoder) != FLAC__SEEKABLE_STREAM_DECODER_OK) do_something;</div>
</div><!-- fragment --><p>In <a class="el" href="namespace_f_l_a_c.html">FLAC</a> 1.1.3 it is like this:</p>
<div class="fragment"><div class="line"><a class="code" href="struct_f_l_a_c_____stream_decoder.html">FLAC__StreamDecoder</a> *decoder = <a class="code" href="group__flac__stream__decoder.html#ga8e25ac9f30480316dcd33f82c5a5812d">FLAC__stream_decoder_new</a>();</div>
<div class="line"><span class="keywordflow">if</span>(decoder == <a class="code" href="begin__code_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) do_something;</div>
<div class="line"><a class="code" href="group__flac__stream__decoder.html#ga48074d18a17ea88e8272cc8f865ae6e6">FLAC__stream_decoder_set_md5_checking</a>(decoder, <span class="keyword">true</span>);</div>
<div class="line">[... other settings ...]</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code" href="group__flac__stream__decoder.html#ga32c28a56a2bdfa2333edbd3d991894d7">FLAC__stream_decoder_init_stream</a>(</div>
<div class="line">  decoder,</div>
<div class="line">  my_read_callback,</div>
<div class="line">  my_seek_callback,      <span class="comment">// or NULL</span></div>
<div class="line">  my_tell_callback,      <span class="comment">// or NULL</span></div>
<div class="line">  my_length_callback,    <span class="comment">// or NULL</span></div>
<div class="line">  my_eof_callback,       <span class="comment">// or NULL</span></div>
<div class="line">  my_write_callback,</div>
<div class="line">  my_metadata_callback,  <span class="comment">// or NULL</span></div>
<div class="line">  my_error_callback,</div>
<div class="line">  my_client_data</div>
<div class="line">) != <a class="code" href="group__flac__stream__decoder.html#ggaaed54a24ac6310d29c5cafba79759c44ac94c7e9396f30642f34805e5d626e011">FLAC__STREAM_DECODER_INIT_STATUS_OK</a>) do_something;</div>
</div><!-- fragment --><p>or you could do;</p>
<div class="fragment"><div class="line">[...]</div>
<div class="line">FILE *file = fopen(<span class="stringliteral">&quot;somefile.flac&quot;</span>,<span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span>(file == <a class="code" href="begin__code_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) do_somthing;</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code" href="group__flac__stream__decoder.html#ga38f9eb46bf112af205f86b4cbac9980c">FLAC__stream_decoder_init_FILE</a>(</div>
<div class="line">  decoder,</div>
<div class="line">  file,</div>
<div class="line">  my_write_callback,</div>
<div class="line">  my_metadata_callback,  <span class="comment">// or NULL</span></div>
<div class="line">  my_error_callback,</div>
<div class="line">  my_client_data</div>
<div class="line">) != <a class="code" href="group__flac__stream__decoder.html#ggaaed54a24ac6310d29c5cafba79759c44ac94c7e9396f30642f34805e5d626e011">FLAC__STREAM_DECODER_INIT_STATUS_OK</a>) do_something;</div>
</div><!-- fragment --><p>or just:</p>
<div class="fragment"><div class="line">[...]</div>
<div class="line"><span class="keywordflow">if</span>(<a class="code" href="group__flac__stream__decoder.html#ga1692108a97012d1c5f79baf7df012c33">FLAC__stream_decoder_init_file</a>(</div>
<div class="line">  decoder,</div>
<div class="line">  <span class="stringliteral">&quot;somefile.flac&quot;</span>,</div>
<div class="line">  my_write_callback,</div>
<div class="line">  my_metadata_callback,  <span class="comment">// or NULL</span></div>
<div class="line">  my_error_callback,</div>
<div class="line">  my_client_data</div>
<div class="line">) != <a class="code" href="group__flac__stream__decoder.html#ggaaed54a24ac6310d29c5cafba79759c44ac94c7e9396f30642f34805e5d626e011">FLAC__STREAM_DECODER_INIT_STATUS_OK</a>) do_something;</div>
</div><!-- fragment --><p>Another small change to the decoder is in how it handles unparseable streams. Before, when the decoder found an unparseable stream (reserved for when the decoder encounters a stream from a future encoder that it can't parse), it changed the state to <code>FLAC__STREAM_DECODER_UNPARSEABLE_STREAM</code>. Now the decoder instead drops sync and calls the error callback with a new error code <code>FLAC__STREAM_DECODER_ERROR_STATUS_UNPARSEABLE_STREAM</code>. This is more robust. If your error callback does not discriminate on the the error state, your code does not need to be changed.</p>
<p>The encoder now has a new setting: <a class="el" href="group__flac__stream__encoder.html#ga83d38fd6fca7abbf8363bdc2536a299e">FLAC__stream_encoder_set_apodization()</a>. This is for setting the method used to window the data before LPC analysis. You only need to add a call to this function if the default is not suitable. There are also two new convenience functions that may be useful: <a class="el" href="group__flac__metadata__object.html#ga897138ca0a985d8741f73d6657f38845">FLAC__metadata_object_cuesheet_calculate_cddb_id()</a> and <a class="el" href="group__flac__metadata__level0.html#ga6ee2633dc179c2a0cb5fef5762faf0fd">FLAC__metadata_get_cuesheet()</a>.</p>
<p>The <em>bytes</em> parameter to FLAC__StreamDecoderReadCallback, FLAC__StreamEncoderReadCallback, and FLAC__StreamEncoderWriteCallback is now <code>size_t</code> instead of <code>unsigned</code>. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 3 2016 16:16:02 for Arcade by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
